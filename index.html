<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BHBL Dice Baseball</title>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#0b1020" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <div>
      <h1>BHBL Dice Baseball</h1>
      <div class="sub">v2 — Lineups + Schedule. Installable (PWA). Saves locally on your PC.</div>
    </div>
    <nav class="tabs">
      <button class="tab active" data-tab="play">Play</button>
      <button class="tab" data-tab="league">League</button>
      <button class="tab" data-tab="schedule">Schedule</button>
      <button class="tab" data-tab="standings">Standings</button>
      <button class="tab" data-tab="stats">Stats</button>
      <button class="tab" data-tab="pitching">Pitching</button>
      <button class="tab" data-tab="backup">Backup</button>
    </nav>
  </header>

  <main>
    <section class="panel active" id="play">
      <div class="grid2">
        <div class="card">
          <h2>Game</h2>
          <div class="row">
            <label>Home</label><select id="homeTeam"></select>
            <label>Away</label><select id="awayTeam"></select>
            <label>Home P</label><select id="homePitcher"></select>
            <label>Away P</label><select id="awayPitcher"></select>
            <button id="startGame" class="primary">Start</button>
            <button id="editLineup">Edit Lineups</button>
            <button id="editPitchers">Edit Pitchers</button>
          </div>

          <div class="row">
            <div class="pill">Inning: <span id="inning">-</span></div>
            <div class="pill">Half: <span id="half">-</span></div>
            <div class="pill">Outs: <span id="outs">-</span></div>
          </div>

          <div class="bases">
            <div class="base" id="b1">1B</div>
            <div class="base" id="b2">2B</div>
            <div class="base" id="b3">3B</div>
          </div>

          <div class="score" id="score">Start a game.</div>

          <div class="row">
            <button id="roll" class="primary">Roll 2d6</button>
            <button id="simHalf">Sim Half</button>
            <button id="simGame">Sim Game</button>
            <button id="finalizeGame" class="primary">Finalize Game (Season)</button>
          </div>

          <div class="row">
            <div class="pill">Home P: <span id="curHomeP">-</span></div>
            <div class="pill">Away P: <span id="curAwayP">-</span></div>
          </div>

          <div class="row">
            <div class="pill">Batter: <span id="batter">-</span></div>
            <div class="pill">Tier: <span id="tier">-</span></div>
            <div class="pill">HR: <span id="hr">-</span></div>
          </div>

          <pre class="log" id="log"></pre>

          <div class="hint">
            New: saved batting orders per team + in-game lineup edits. Next: pitching, box scores, season standings.
          </div>
        </div>

        <div class="card">
          <h2>Quick Actions</h2>
          <div class="hint">Schedule games, then simulate from the Schedule tab.</div>
          <div class="row">
            <button id="jumpSchedule">Go to Schedule</button>
            <button id="jumpLeague">Go to League</button>
          </div>
          <hr class="sep"/>
          <div class="hint"><b>Lineups:</b> League tab saves a default batting order per team. In-game edits affect only the current game.</div>
        </div>
      </div>
    </section>

    <section class="panel" id="league">
      <div class="grid2">
        <div class="card">
          <h2>Teams</h2>
          <div class="row">
            <input id="newTeam" placeholder="Team name" />
            <button id="addTeam" class="primary">Add</button>
          </div>
          <div id="teamsList"></div>
        </div>

        <div class="card">
          <h2>Players</h2>
          <div class="row">
            <label>Team</label><select id="rosterTeam"></select>
          </div>
          <div class="row">
            <input id="playerName" placeholder="Player name" />
            <input id="playerPos" placeholder="Pos (SS)" />
          </div>
          <div class="row">
            <label>BA Tier</label>
            <select id="playerTier"></select>
            <label>HR</label>
            <select id="playerHr">
              <option value="lt20">&lt; 20 HR</option>
              <option value="ge20">20+ HR</option>
            </select>
            <button id="addPlayer" class="primary">Add Player</button>
          </div>
          <div id="rosterList"></div>
        </div>
      </div>

      <div class="card" style="margin-top:12px">
        <h2>Batting Order (Drag to reorder)</h2>
        <div class="row">
          <label>Team</label><select id="lineupTeam"></select>
          <button id="saveLineup" class="primary">Save Lineup</button>
          <span class="small">Saved lineup is used when you start a new game.</span>
        </div>
        <div class="hint">Drag players to set the 1–9 batting order. If you have more than 9, the extra players are bench.</div>
        <div class="lineupWrap">
          <ol id="lineupList" class="dndList"></ol>
          <div>
            <div class="small" style="margin-bottom:6px">Bench (optional)</div>
            <ul id="benchList" class="dndList"></ul>
          </div>
        </div>
      
      <div class="card" style="margin-top:12px">
        <h2>Pitchers</h2>
        <div class="row">
          <label>Team</label><select id="pitRosterTeam"></select>
        </div>
        <div class="row">
          <input id="pitcherName" placeholder="Pitcher name" />
          <label>Role</label>
          <select id="pitcherRole">
            <option value="SP">SP</option>
            <option value="RP">RP</option>
          </select>
          <button id="addPitcher" class="primary">Add Pitcher</button>
        </div>
        <div class="row">
          <label>Default SP</label><select id="defaultSP"></select>
        </div>
        <div id="pitcherList"></div>
        <div class="hint">Default SP is pre-selected when you start a game. You can switch pitchers during a game.</div>
      </div>

      </div>
    </section>

    <section class="panel" id="schedule">
      <div class="card">
        <h2>Schedule</h2>
        <div class="row">
<label>Away</label><select id="schedAway"></select>
          <label>Home</label><select id="schedHome"></select>
          <button id="addGame" class="primary">Add Game</button>
        </div>
        <div class="row">
          <button id="simSelected" class="primary">Sim Selected Game</button>
          <button id="playSelected">Play Selected Game</button>
          <button id="deleteSelected" class="danger">Delete Selected</button>
          <button id="simAll">Sim All Remaining</button>
        </div>
        <div class="hint">Tip: click a scheduled game to select it. Completed games are marked “Final”.</div>
        <div id="scheduleList" class="scheduleList"></div>
      </div>
    </section>


    <section class="panel" id="standings">
      <div class="card">
        <h2>Standings</h2>
        <div class="row">
          <button id="recalcStandings" class="primary">Recalculate</button>
          <span class="small">Standings update automatically when scheduled games are simulated.</span>
        </div>
        <div class="tableWrap"><table id="standingsTable"></table></div>
      </div>
    </section>


    <section class="panel" id="stats">
      <div class="card">
        <h2>Season Batting Stats</h2>
        <div class="row">
          <label>Team</label><select id="statsTeam"></select>
          <button id="resetStats" class="danger">Reset Season</button>
        </div>
        <div class="tableWrap"><table id="battingTable"></table></div>
      </div>
    </section>


    <section class="panel" id="pitching">
      <div class="card">
        <h2>Season Pitching Stats</h2>
        <div class="row">
          <label>Team</label><select id="pitchTeam"></select>
        </div>
        <div class="tableWrap"><table id="pitchTable"></table></div>
        <div class="hint">Pitchers do NOT change outcomes. v4.3 only tracks stats to the active pitcher.</div>
      </div>
    </section>


    <section class="panel" id="backup">
      <div class="card">
        <h2>Backup</h2>
        <div class="row">
          <button id="exportJson" class="primary">Export JSON</button>
          <input id="importFile" type="file" accept=".json" />
          <button id="importJson">Import JSON</button>
        </div>
        <div class="hint">
          Data saves locally on your PC automatically. Export is your “backup file.”
        </div>
      </div>
    </section>
  </main>

  <div class="modal" id="lineupModal" aria-hidden="true">
    <div class="modalCard">
      <div class="row" style="justify-content:space-between">
        <h2 style="margin:0">Edit Lineups (This Game)</h2>
        <button id="closeModal">Close</button>
      </div>
      <div class="hint">Drag to reorder. This does not change saved lineups in League tab.</div>
      <div class="grid2">
        <div class="card" style="background:#0b1229">
          <h3 class="h3" id="modalAwayName">Away</h3>
          <ol id="modalAwayList" class="dndList"></ol>
        </div>
        <div class="card" style="background:#0b1229">
          <h3 class="h3" id="modalHomeName">Home</h3>
          <ol id="modalHomeList" class="dndList"></ol>
        </div>
      </div>
      <div class="row" style="justify-content:flex-end">
        <button id="modalSave" class="primary">Save Changes</button>
      </div>
    </div>
  </div>
  <div class="modal" id="pitchModal" aria-hidden="true">
    <div class="modalCard">
      <div class="row" style="justify-content:space-between">
        <h2 style="margin:0">Edit Pitchers (This Game)</h2>
        <button id="closePitchModal">Close</button>
      </div>
      <div class="hint">Pick the active pitcher for each team. Pitchers do NOT affect outcomes.</div>
      <div class="grid2">
        <div class="card" style="background:#0b1229">
          <h3 class="h3" id="pitchAwayName">Away</h3>
          <div class="row"><label>Pitcher</label><select id="pitchAwaySelect"></select></div>
        </div>
        <div class="card" style="background:#0b1229">
          <h3 class="h3" id="pitchHomeName">Home</h3>
          <div class="row"><label>Pitcher</label><select id="pitchHomeSelect"></select></div>
        </div>
      </div>
      <div class="row" style="justify-content:flex-end">
        <button id="pitchSave" class="primary">Save Changes</button>
      </div>
    </div>
  </div>


  <script src="app.js"></script>
</body>
</html>
